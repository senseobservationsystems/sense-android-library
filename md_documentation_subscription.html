<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Sense Android Library: Data Subscription</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Sense Android Library
   &#160;<span id="projectnumber">3.4</span>
   </div>
   <div id="projectbrief">Android library project for the Sense Platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_documentation_subscription.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Data Subscription </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="subscription_manager"></a>
Subscription Manager</h1>
<p>Sense Library provides SubscriptionManager to keep all of the available producers and subscribers as well as relations between them. Every sensor in sense library should be registered to this SubscriptionManager instance.</p>
<p>This class, like most of other class in Sense Library, is implemented with singleton pattern. It's implemented in <a class="el" href="classnl_1_1sense__os_1_1service_1_1subscription_1_1_subscription_manager.html">nl.sense_os.service.subscription.SubscriptionManager</a>.</p>
<p>A <a href="##DataProducer">DataProducer</a> can register to <a href="##SubscribtionManager">SubscriptionManager</a> instance with a given name. One name in SubscriptionManager could be registered to one or more different DataProducer instances. Registering an existing instance of DataProducer will result in doing nothing.</p>
<p>A <a href="##DataConsumer">DataConsumer</a> can subscribe to one or more <a href="##DataProducer">DataProducer</a> registered under a certain name. If there is no DataProducer for this name yet, SubscriptionManager will still store it as a subscriber and subscribe it when a new DataProducer is registered with that name.</p>
<h1><a class="anchor" id="data_producer"></a>
Data Producer</h1>
<p>DataProducer is an interface that specifies some functionality for objects that produce data, specifically <a href="##SensorDataPoint">SensorDataPoint</a> objects, so that one or more <a href="##DataConsumer">DataConsumer</a> can subscribe to it. Every sensor in Sense Library is an implementation of DataProducer.</p>
<p>Sense library provides a base implementation of this interface in <a class="el" href="classnl_1_1sense__os_1_1service_1_1subscription_1_1_base_data_producer.html">nl.sense_os.service.subscription.BaseDataProducer</a> abstract class, and almost all of sensors in Sense library are based on this class. BaseDataProducer will store all of its subcribers in an ArrayList. This class also provides a mechanisme to notify all of its subscribers when there are new samples, and also send the SensorDataPoint to some or all of its subscribers when the sampling is finished. BaseDataProducer object will check the status of its DataConsumers to see if they have received all the data they need before sending the data.</p>
<p>DataProducer can register to SubscriptionManager so a DataConsumer can subscribe to it. Here is an example of how to register a producer to SubscriptionManager</p>
<div class="fragment"><div class="line">mSubscrMgr = SubscriptionManager.getInstance();</div>
<div class="line">testSensor = TestSensor.getInstance(ctx);</div>
<div class="line">mSubscrMgr.registerProducer(“TestSensor”, testSensor);</div>
</div><!-- fragment --><p>BaseDataProducer objects like sensors should also notify and send the datapoint everytime there is a new sample. Here is an example of how to notify and send sensor data to subscribers when there is a new sample.</p>
<div class="fragment"><div class="line">notifySubscribers();</div>
<div class="line">SensorDataPoint dataPoint = <span class="keyword">new</span> SensorDataPoint(value);</div>
<div class="line">dataPoint.sensorName = <span class="stringliteral">&quot;Sensor name&quot;</span>;</div>
<div class="line">dataPoint.sensorDescription = <span class="stringliteral">&quot;Sensor description&quot;</span>;</div>
<div class="line">dataPoint.timeStamp = startTimestamp;</div>
<div class="line">sendToSubscribers(dataPoint);</div>
</div><!-- fragment --><h1><a class="anchor" id="data_consumer"></a>
Data Consumer</h1>
<p>DataConsumer is an interface that specifies some functionality for objects to subscribe to one or more <a href="##DataProducer">DataProducer</a>. By subscribing to a DataProducer, a DataConsumer object will get a notification every time there is a new datapoint, as well as get the actual data. Any class that implements this interface also needs to implement a function that enables the DataProducer to check if the DataConsumer object has all of the data it needs before sending the actual data.</p>
<p>FallDetector and EpilepsySensor are examples of DataConsumer.</p>
<p>DataConsumer can subscribe to a DataProducer directly or through SubscriptionManager. Here is an example on how to subscribe a DataConsumer to a data producer directly</p>
<div class="fragment"><div class="line">testConsumerSensor = TestConsumerSensor.getInstance();</div>
<div class="line">dataProducer.addSubscriber(testConsumerSensor);</div>
</div><!-- fragment --><p>and here is an example of how to subscribe a DataConsumer to DataProducer in previous example (see DataProducer) using SubscriptionManager.</p>
<div class="fragment"><div class="line">testConsumerSensor = TestConsumerSensor.getInstance();</div>
<div class="line"></div>
<div class="line">mSubscrMgr = SubscriptionManager.getInstance();</div>
<div class="line">mSubscrMgr.subscribeConsumer(<span class="stringliteral">&quot;TestSensor&quot;</span>, testConsumerSensor);</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Mar 30 2015 17:48:16 for Sense Android Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
